(function(){"use strict";var e={7930:function(e,t,s){var n=s(3751),o=s(641);const r={class:"app-container"},a={class:"content-wrapper"};function i(e,t,s,i,l,c){const u=(0,o.g2)("Login"),h=(0,o.g2)("Register"),d=(0,o.g2)("ChatInterface");return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.Lk)("div",a,[(0,o.bF)(n.eB,{name:"fade",mode:"out-in"},{default:(0,o.k6)((()=>["login"===l.currentView?((0,o.uX)(),(0,o.Wv)(u,{key:0,onLoginSuccess:c.onLoginSuccess,onShowRegister:c.showRegister},null,8,["onLoginSuccess","onShowRegister"])):"register"===l.currentView?((0,o.uX)(),(0,o.Wv)(h,{key:1,onShowLogin:c.showLogin},null,8,["onShowLogin"])):((0,o.uX)(),(0,o.Wv)(d,{key:2,onLogout:c.logout},null,8,["onLogout"]))])),_:1})])])}const l=(0,o.Lk)("h1",null,"AI Chat Login",-1),c={class:"switch-form"};function u(e,t,s,r,a,i){return(0,o.uX)(),(0,o.CE)("div",null,[l,(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.username=e),placeholder:"Username",required:""},null,512),[[n.Jo,a.username]]),(0,o.bo)((0,o.Lk)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e),placeholder:"Password",required:""},null,512),[[n.Jo,a.password]]),(0,o.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>i.login&&i.login(...e))},"Login"),(0,o.Lk)("div",c,[(0,o.Lk)("a",{href:"#",onClick:t[3]||(t[3]=(0,n.D$)((t=>e.$emit("show-register")),["prevent"]))},"Don't have an account? Register")])])}var h={name:"LoginForm",data(){return{username:"",password:""}},methods:{login(){fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this.password})}).then((e=>e.json())).then((e=>{"登录成功"===e.message?this.$emit("login-success"):alert(e.message)})).catch((e=>{console.error("Error:",e)}))}}},d=s(6262);const g=(0,d.A)(h,[["render",u]]);var p=g;const m=(0,o.Lk)("h1",null,"Register",-1),f={class:"switch-form"};function y(e,t,s,r,a,i){return(0,o.uX)(),(0,o.CE)("div",null,[m,(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.username=e),placeholder:"Username",required:""},null,512),[[n.Jo,a.username]]),(0,o.bo)((0,o.Lk)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e),placeholder:"Password",required:""},null,512),[[n.Jo,a.password]]),(0,o.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>i.register&&i.register(...e))},"Register"),(0,o.Lk)("div",f,[(0,o.Lk)("a",{href:"#",onClick:t[3]||(t[3]=(0,n.D$)((t=>e.$emit("show-login")),["prevent"]))},"Already have an account? Login")])])}var v={name:"RegisterForm",data(){return{username:"",password:""}},methods:{register(){fetch("/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this.password})}).then((e=>e.json())).then((e=>{alert(e.message),"注册成功"===e.message&&this.$emit("show-login")})).catch((e=>{console.error("Error:",e)}))}}};const L=(0,d.A)(v,[["render",y]]);var k=L;const w=e=>((0,o.Qi)("data-v-0cbd707b"),e=e(),(0,o.jt)(),e),b={class:"chat-container"},C={class:"chat-header"},T=w((()=>(0,o.Lk)("h1",null,"Chat with AI",-1))),A={class:"header-buttons"},I=w((()=>(0,o.Lk)("i",{class:"fas fa-sign-out-alt"},null,-1))),O=w((()=>(0,o.Lk)("i",{class:"fas fa-trash-alt"},null,-1))),S={class:"chat-messages",ref:"chatMessages"},M={class:"chat-input"},E=w((()=>(0,o.Lk)("i",{class:"fas fa-paper-plane"},null,-1))),j=[E],_={class:"file-upload"},x=w((()=>(0,o.Lk)("i",{class:"fas fa-upload"},null,-1)));function $(e,t,s,r,a,i){const l=(0,o.g2)("ChatMessageComponent");return(0,o.uX)(),(0,o.CE)("div",b,[(0,o.Lk)("div",C,[T,(0,o.Lk)("div",A,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>i.logout&&i.logout(...e)),class:"logout-button"},[I,(0,o.eW)(" Logout ")]),(0,o.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>i.clearHistory&&i.clearHistory(...e)),class:"clear-history-button"},[O,(0,o.eW)(" Clear History ")])])]),(0,o.Lk)("div",S,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.messages,((e,t)=>((0,o.uX)(),(0,o.Wv)(l,{key:t,message:e},null,8,["message"])))),128))],512),(0,o.Lk)("div",M,[(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.userInput=e),onKeyup:t[3]||(t[3]=(0,n.jR)(((...e)=>i.sendMessage&&i.sendMessage(...e)),["enter"])),placeholder:"Type your message..."},null,544),[[n.Jo,a.userInput]]),(0,o.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>i.sendMessage&&i.sendMessage(...e)),class:"send-button"},j)]),(0,o.Lk)("div",_,[(0,o.Lk)("input",{type:"file",onChange:t[5]||(t[5]=(...e)=>i.handleFileUpload&&i.handleFileUpload(...e)),multiple:"",accept:".txt,.pdf,.docx",ref:"fileInput",style:{display:"none"}},null,544),(0,o.Lk)("button",{onClick:t[6]||(t[6]=t=>e.$refs.fileInput.click()),class:"upload-button"},[x,(0,o.eW)(" Upload Files ")])])])}var F=s(33);const R={class:"message-bubble"},V=["innerHTML"];function U(e,t,s,n,r,a){return(0,o.uX)(),(0,o.CE)("div",{class:(0,F.C4)(["message","user"===s.message.sender?"user-message":"ai-message"])},[(0,o.Lk)("div",R,[(0,o.Lk)("div",{class:"message-content",innerHTML:a.formattedMessage},null,8,V)])],2)}s(3817);var X=s(7453),H=s(508),P={name:"ChatMessageComponent",props:{message:{type:Object,required:!0}},computed:{formattedMessage(){return"ai"===this.message.sender?(0,X.xI)(this.message.content,{highlight:function(e,t){const s=H.A.getLanguage(t)?t:"plaintext";return H.A.highlight(e,{language:s}).value}}):this.message.content}},mounted(){"ai"===this.message.sender&&this.$nextTick((()=>{this.$el.querySelectorAll("pre code").forEach((e=>{H.A.highlightElement(e)}))}))}};const J=(0,d.A)(P,[["render",U],["__scopeId","data-v-e25c2be8"]]);var q=J,W=s(2053),B={name:"ChatInterface",components:{ChatMessageComponent:q},data(){return{messages:[],userInput:"",isLoading:!1}},mounted(){this.loadChatHistory(),this.scrollToBottom()},methods:{async sendMessage(){if(""===this.userInput.trim())return;const e={sender:"user",content:this.userInput};this.messages.push(e),this.userInput="",this.scrollToBottom(),this.isLoading=!0;try{const t=await fetch("/ask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e.content})}),s=t.body.getReader(),n=new TextDecoder("utf-8");let o="";while(1){const{done:e,value:t}=await s.read();if(e)break;const r=n.decode(t);o+=r,this.updateLastAIMessage(o)}}catch(t){console.error("Error:",t)}finally{this.isLoading=!1,this.scrollToBottom()}},updateLastAIMessage(e){const t=this.messages[this.messages.length-1];"ai"===t.sender?t.content=e:this.messages.push({sender:"ai",content:e})},scrollToBottom(){this.$nextTick((()=>{const e=this.$refs.chatMessages;e.scrollTop=e.scrollHeight}))},logout(){W.A.get("/logout").then((()=>{this.$emit("logout")})).catch((e=>{console.error("Logout error:",e)}))},async loadChatHistory(){try{const e=await W.A.get("/get_chat_history");this.messages=e.data.chat_history}catch(e){console.error("Error loading chat history:",e)}},async clearHistory(){try{await W.A.post("/clear_chat_history"),this.messages=[]}catch(e){console.error("Error clearing chat history:",e)}},async handleFileUpload(){const e=this.$refs.fileInput.files;if(0===e.length)return;const t=new FormData;for(let n=0;n<e.length;n++)t.append("files",e[n]);try{const e=await W.A.post("/upload",t,{headers:{"Content-Type":"multipart/form-data"}});console.log(e.data.message),this.messages.push({sender:"system",content:"Files uploaded successfully"})}catch(s){console.error("Error uploading files:",s),this.messages.push({sender:"system",content:"File upload failed"})}}}};const D=(0,d.A)(B,[["render",$],["__scopeId","data-v-0cbd707b"]]);var N=D,K={name:"App",components:{Login:p,Register:k,ChatInterface:N},data(){return{currentView:"login"}},methods:{onLoginSuccess(){this.currentView="chat"},showRegister(){this.currentView="register"},showLogin(){this.currentView="login"},logout(){this.currentView="login"}}};const Q=(0,d.A)(K,[["render",i]]);var z=Q,G=s(5798);const Y=[{path:"/login",component:p},{path:"/register",component:k},{path:"/chat",component:N}],Z=(0,G.aE)({history:(0,G.LA)(),routes:Y});var ee=Z;(0,n.Ef)(z).use(ee).mount("#app")}},t={};function s(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,s),r.exports}s.m=e,function(){var e=[];s.O=function(t,n,o,r){if(!n){var a=1/0;for(u=0;u<e.length;u++){n=e[u][0],o=e[u][1],r=e[u][2];for(var i=!0,l=0;l<n.length;l++)(!1&r||a>=r)&&Object.keys(s.O).every((function(e){return s.O[e](n[l])}))?n.splice(l--,1):(i=!1,r<a&&(a=r));if(i){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[n,o,r]}}(),function(){s.d=function(e,t){for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,r,a=n[0],i=n[1],l=n[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(o in i)s.o(i,o)&&(s.m[o]=i[o]);if(l)var u=l(s)}for(t&&t(n);c<a.length;c++)r=a[c],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(u)},n=self["webpackChunkai_chat_app"]=self["webpackChunkai_chat_app"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=s.O(void 0,[504],(function(){return s(7930)}));n=s.O(n)})();
//# sourceMappingURL=app.972adedf.js.map