(function(){"use strict";var e={9712:function(e,t,n){var o=n(3751),s=n(641);const r={class:"min-h-screen bg-gray-100 flex items-center justify-center"};function a(e,t,n,a,i,l){const c=(0,s.g2)("Login"),d=(0,s.g2)("Register"),u=(0,s.g2)("ChatInterface");return(0,s.uX)(),(0,s.CE)("div",r,[(0,s.bF)(o.eB,{name:"fade",mode:"out-in"},{default:(0,s.k6)((()=>["login"===i.currentView?((0,s.uX)(),(0,s.Wv)(c,{key:0,onLoginSuccess:l.onLoginSuccess,onShowRegister:l.showRegister},null,8,["onLoginSuccess","onShowRegister"])):"register"===i.currentView?((0,s.uX)(),(0,s.Wv)(d,{key:1,onShowLogin:l.showLogin},null,8,["onShowLogin"])):((0,s.uX)(),(0,s.Wv)(u,{key:2,onLogout:l.logout},null,8,["onLogout"]))])),_:1})])}const i=e=>((0,s.Qi)("data-v-ef5ace1a"),e=e(),(0,s.jt)(),e),l={class:"bg-white p-8 rounded-lg shadow-md w-full max-w-md transform transition-all duration-300 hover:shadow-xl"},c=i((()=>(0,s.Lk)("h1",{class:"text-2xl font-semibold text-center mb-6 animate-fade-in"},"Login",-1))),d={class:"text-center mt-4 animate-fade-in"};function u(e,t,n,r,a,i){return(0,s.uX)(),(0,s.CE)("div",l,[c,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.username=e),placeholder:"Username",required:"",class:"w-full px-4 py-2 mb-4 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-300 animate-slide-up"},null,512),[[o.Jo,a.username]]),(0,s.bo)((0,s.Lk)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e),placeholder:"Password",required:"",class:"w-full px-4 py-2 mb-4 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-300 animate-slide-up"},null,512),[[o.Jo,a.password]]),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>i.login&&i.login(...e)),class:"w-full bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 transition duration-300 transform hover:-translate-y-1 hover:shadow-md animate-pulse"}," Login "),(0,s.Lk)("div",d,[(0,s.Lk)("a",{href:"#",onClick:t[3]||(t[3]=(0,o.D$)((t=>e.$emit("show-register")),["prevent"])),class:"text-indigo-600 hover:underline font-medium transition-colors duration-300"}," Don't have an account? Register ")])])}var h={name:"LoginForm",data(){return{username:"",password:""}},methods:{login(){fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this.password})}).then((e=>e.json())).then((e=>{"登录成功"===e.message?this.$emit("login-success"):alert(e.message)})).catch((e=>{console.error("Error:",e)}))}}},g=n(6262);const p=(0,g.A)(h,[["render",u],["__scopeId","data-v-ef5ace1a"]]);var m=p;const f=e=>((0,s.Qi)("data-v-a203deb4"),e=e(),(0,s.jt)(),e),v={class:"bg-white p-8 rounded-lg shadow-md w-full max-w-md transform transition-all duration-300 hover:shadow-xl"},y=f((()=>(0,s.Lk)("h1",{class:"text-2xl font-semibold text-center mb-6 animate-fade-in"},"Register",-1))),w={class:"text-center mt-4 animate-fade-in"};function b(e,t,n,r,a,i){return(0,s.uX)(),(0,s.CE)("div",v,[y,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.username=e),placeholder:"Username",required:"",class:"w-full px-4 py-2 mb-4 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-300 animate-slide-up"},null,512),[[o.Jo,a.username]]),(0,s.bo)((0,s.Lk)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e),placeholder:"Password",required:"",class:"w-full px-4 py-2 mb-4 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 transition duration-300 animate-slide-up"},null,512),[[o.Jo,a.password]]),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>i.register&&i.register(...e)),class:"w-full bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 transition duration-300 transform hover:-translate-y-1 hover:shadow-md animate-pulse"}," Register "),(0,s.Lk)("div",w,[(0,s.Lk)("a",{href:"#",onClick:t[3]||(t[3]=(0,o.D$)((t=>e.$emit("show-login")),["prevent"])),class:"text-indigo-600 hover:underline font-medium transition-colors duration-300"}," Already have an account? Login ")])])}var x={name:"RegisterForm",data(){return{username:"",password:""}},methods:{register(){fetch("/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this.password})}).then((e=>e.json())).then((e=>{alert(e.message),"注册成功"===e.message&&this.$emit("show-login")})).catch((e=>{console.error("Error:",e)}))}}};const k=(0,g.A)(x,[["render",b],["__scopeId","data-v-a203deb4"]]);var L=k,C=n(33);const _=e=>((0,s.Qi)("data-v-a1e40dc6"),e=e(),(0,s.jt)(),e),I={class:"flex h-screen w-screen"},A={class:"w-1/5 bg-gray-800 text-white flex flex-col transition-all duration-300 ease-in-out"},E={class:"p-4"},T={class:"flex-1 overflow-y-auto"},O=["onClick"],j={class:"w-4/5 flex flex-col bg-gray-100 transition-all duration-300 ease-in-out"},S={class:"bg-indigo-600 text-white px-6 py-3 flex justify-between items-center"},M=_((()=>(0,s.Lk)("h1",{class:"text-lg font-semibold animate-fade-in"},"Chat Bot",-1))),F={class:"space-x-4"},$=_((()=>(0,s.Lk)("i",{class:"fas fa-sign-out-alt mr-2"},null,-1))),R=_((()=>(0,s.Lk)("i",{class:"fas fa-trash-alt mr-2"},null,-1))),V={class:"flex-1 overflow-y-auto px-6 py-4",ref:"chatMessages"},X={class:"bg-white px-6 py-4 border-t border-gray-200"},H={class:"flex items-center space-x-2"},P=_((()=>(0,s.Lk)("i",{class:"fas fa-paper-plane"},null,-1))),U=[P],J=_((()=>(0,s.Lk)("i",{class:"fas fa-upload"},null,-1))),q=[J];function B(e,t,n,r,a,i){const l=(0,s.g2)("ChatMessageComponent");return(0,s.uX)(),(0,s.CE)("div",I,[(0,s.Lk)("div",A,[(0,s.Lk)("div",E,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>i.newConversation&&i.newConversation(...e)),class:"w-full bg-indigo-600 text-white py-2 rounded-md hover:bg-indigo-700 transition duration-300 transform hover:-translate-y-1 hover:shadow-md animate-pulse"}," New Conversation ")]),(0,s.Lk)("div",T,[(0,s.bF)(o.F,{name:"list",tag:"div"},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.conversations,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,onClick:e=>i.switchConversation(t),class:(0,C.C4)(["p-3 hover:bg-gray-700 cursor-pointer transition duration-300",{"bg-gray-700":a.currentConversationIndex===t}])}," Conversation "+(0,C.v_)(t+1),11,O)))),128))])),_:1})])]),(0,s.Lk)("div",j,[(0,s.Lk)("div",S,[M,(0,s.Lk)("div",F,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>i.logout&&i.logout(...e)),class:"px-3 py-1 border border-white rounded-full text-sm hover:bg-white hover:text-indigo-600 transition duration-300 transform hover:-translate-y-1"},[$,(0,s.eW)(" Logout ")]),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>i.clearHistory&&i.clearHistory(...e)),class:"px-3 py-1 border border-white rounded-full text-sm hover:bg-white hover:text-indigo-600 transition duration-300 transform hover:-translate-y-1"},[R,(0,s.eW)(" Clear History ")])])]),(0,s.Lk)("div",V,[(0,s.bF)(o.F,{name:"message",tag:"div"},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.messages,((e,t)=>((0,s.uX)(),(0,s.Wv)(l,{key:t,message:e},null,8,["message"])))),128))])),_:1})],512),(0,s.Lk)("div",X,[(0,s.Lk)("div",H,[(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>a.userInput=e),onKeyup:t[4]||(t[4]=(0,o.jR)(((...e)=>i.sendMessage&&i.sendMessage(...e)),["enter"])),placeholder:"Type your message...",class:"flex-1 px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none transition duration-300"},null,544),[[o.Jo,a.userInput]]),(0,s.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>i.sendMessage&&i.sendMessage(...e)),class:"bg-indigo-600 text-white p-2 rounded-md hover:bg-indigo-700 transition duration-300 transform hover:-translate-y-1 hover:shadow-md"},U),(0,s.Lk)("input",{type:"file",onChange:t[6]||(t[6]=(...e)=>i.handleFileUpload&&i.handleFileUpload(...e)),multiple:"",accept:".txt,.pdf,.docx",ref:"fileInput",class:"hidden"},null,544),(0,s.Lk)("button",{onClick:t[7]||(t[7]=t=>e.$refs.fileInput.click()),class:"bg-indigo-600 text-white p-2 rounded-md hover:bg-indigo-700 transition duration-300 transform hover:-translate-y-1 hover:shadow-md"},q)])])])])}const W=["innerHTML"];function D(e,t,n,o,r,a){return(0,s.uX)(),(0,s.CE)("div",{class:(0,C.C4)(["mb-4","user"===n.message.sender?"text-right":"text-left"])},[(0,s.Lk)("div",{class:(0,C.C4)(["inline-block max-w-[70%] rounded-lg px-4 py-2","user"===n.message.sender?"bg-indigo-600 text-white":"bg-gray-200 text-gray-800"])},[(0,s.Lk)("div",{class:"message-content",innerHTML:a.formattedMessage},null,8,W)],2)],2)}n(8477);var N=n(7453),K=n(508),Q={name:"ChatMessageComponent",props:{message:{type:Object,required:!0}},computed:{formattedMessage(){return"ai"===this.message.sender?(N.xI.setOptions({highlight:function(e,t){return t&&K.A.getLanguage(t)?K.A.highlight(e,{language:t}).value:K.A.highlightAuto(e).value},langPrefix:"hljs language-"}),(0,N.xI)(this.message.content)):this.message.content}},renderedContent(){return N.xI.setOptions({highlight:function(e,t){const n=K.A.getLanguage(t)?t:"plaintext";return K.A.highlight(n,e).value},breaks:!0}),(0,N.xI)(this.message.content)},mounted(){"ai"===this.message.sender&&this.$nextTick((()=>{this.$el.querySelectorAll("pre code").forEach((e=>{K.A.highlightElement(e)}))}))}};const z=(0,g.A)(Q,[["render",D],["__scopeId","data-v-67323704"]]);var G=z,Y=n(2053),Z={name:"ChatInterface",components:{ChatMessageComponent:G},data(){return{messages:[],userInput:"",conversations:[],currentConversationIndex:0,isLoading:!1}},mounted(){this.loadChatHistory(),this.scrollToBottom()},methods:{async sendMessage(){if(""===this.userInput.trim())return;const e={sender:"user",content:this.userInput};this.messages.push(e),this.userInput="",this.scrollToBottom(),this.isLoading=!0;try{const t=await fetch("/ask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e.content})}),n=t.body.getReader(),o=new TextDecoder("utf-8");let s="";while(1){const{done:e,value:t}=await n.read();if(e)break;const r=o.decode(t);s+=r,this.updateLastAIMessage(s)}}catch(t){console.error("Error:",t)}finally{this.isLoading=!1,this.conversations[this.currentConversationIndex]=[...this.messages],this.scrollToBottom()}},updateLastAIMessage(e){const t=this.messages[this.messages.length-1];"ai"===t.sender?t.content=e:this.messages.push({sender:"ai",content:e})},scrollToBottom(){this.$nextTick((()=>{const e=this.$refs.chatMessages;e.scrollTop=e.scrollHeight}))},logout(){Y.A.get("/logout").then((()=>{this.$emit("logout")})).catch((e=>{console.error("Logout error:",e)}))},async loadChatHistory(){try{const e=await Y.A.get("/get_chat_history");this.messages=e.data.chat_history,this.conversations[0]=[...this.messages]}catch(e){console.error("Error loading chat history:",e)}},async clearHistory(){try{await Y.A.post("/clear_chat_history"),this.messages=[],this.conversations[this.currentConversationIndex]=[]}catch(e){console.error("Error clearing chat history:",e)}},async loadConversations(){try{const e=await Y.A.get("/get_conversations");this.conversations=e.data.conversations,this.conversations.length>0&&this.switchConversation(this.conversations[this.conversations.length-1])}catch(e){console.error("Error loading conversations:",e)}},async newConversation(){try{const e=await Y.A.post("/new_conversation");this.conversations.push(e.data.history_num),this.switchConversation(e.data.history_num)}catch(e){console.error("Error creating new conversation:",e)}},async switchConversation(e){this.currentConversationIndex=e;try{const t=await Y.A.post("/switch_conversation",{history_num:e});t.data.chat_history?this.messages=t.data.chat_history.map((e=>({sender:"HumanMessage"===e.type?"user":"ai",content:e.content}))):this.messages=[],this.scrollToBottom()}catch(t){console.error("Error switching conversation:",t)}},async getConversations(){try{const e=await Y.A.get("/get_conversations");this.conversations=e.data.conversations}catch(e){console.error("Error fetching conversations:",e)}},async handleFileUpload(){const e=this.$refs.fileInput.files;if(0===e.length)return;const t=new FormData;for(let o=0;o<e.length;o++)t.append("files",e[o]);try{const e=await Y.A.post("/upload",t,{headers:{"Content-Type":"multipart/form-data"}});console.log(e.data.message),this.messages.push({sender:"system",content:"Files uploaded successfully"})}catch(n){console.error("Error uploading files:",n),this.messages.push({sender:"system",content:"File upload failed"})}}}};const ee=(0,g.A)(Z,[["render",B],["__scopeId","data-v-a1e40dc6"]]);var te=ee,ne={name:"App",components:{Login:m,Register:L,ChatInterface:te},data(){return{currentView:"login"}},methods:{onLoginSuccess(){this.currentView="chat"},showRegister(){this.currentView="register"},showLogin(){this.currentView="login"},logout(){this.currentView="login"}}};const oe=(0,g.A)(ne,[["render",a]]);var se=oe,re=n(5798);const ae=[{path:"/login",component:m},{path:"/register",component:L},{path:"/chat",component:te}],ie=(0,re.aE)({history:(0,re.LA)(),routes:ae});var le=ie;(0,o.Ef)(se).use(le).mount("#app")}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,o,s,r){if(!o){var a=1/0;for(d=0;d<e.length;d++){o=e[d][0],s=e[d][1],r=e[d][2];for(var i=!0,l=0;l<o.length;l++)(!1&r||a>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[l])}))?o.splice(l--,1):(i=!1,r<a&&(a=r));if(i){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[o,s,r]}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var s,r,a=o[0],i=o[1],l=o[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(s in i)n.o(i,s)&&(n.m[s]=i[s]);if(l)var d=l(n)}for(t&&t(o);c<a.length;c++)r=a[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(d)},o=self["webpackChunkai_chat_app"]=self["webpackChunkai_chat_app"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(9712)}));o=n.O(o)})();
//# sourceMappingURL=app.347bc6e3.js.map