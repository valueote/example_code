(function(){"use strict";var e={311:function(e,t,n){var s=n(3751),o=n(641);const r={class:"container"};function a(e,t,n,s,a,i){const u=(0,o.g2)("Login"),c=(0,o.g2)("Register"),l=(0,o.g2)("Chat");return(0,o.uX)(),(0,o.CE)("div",r,["login"===a.currentView?((0,o.uX)(),(0,o.Wv)(u,{key:0,onShowRegister:t[0]||(t[0]=e=>a.currentView="register"),onLoginSuccess:t[1]||(t[1]=e=>a.currentView="chat")})):(0,o.Q3)("",!0),"register"===a.currentView?((0,o.uX)(),(0,o.Wv)(c,{key:1,onShowLogin:t[2]||(t[2]=e=>a.currentView="login")})):(0,o.Q3)("",!0),"chat"===a.currentView?((0,o.uX)(),(0,o.Wv)(l,{key:2,onLogout:t[3]||(t[3]=e=>a.currentView="login")})):(0,o.Q3)("",!0)])}const i=(0,o.Lk)("h1",null,"AI Chat Login",-1),u={class:"switch-form"};function c(e,t,n,r,a,c){return(0,o.uX)(),(0,o.CE)("div",null,[i,(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.username=e),placeholder:"Username",required:""},null,512),[[s.Jo,a.username]]),(0,o.bo)((0,o.Lk)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e),placeholder:"Password",required:""},null,512),[[s.Jo,a.password]]),(0,o.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>c.login&&c.login(...e))},"Login"),(0,o.Lk)("div",u,[(0,o.Lk)("a",{href:"#",onClick:t[3]||(t[3]=(0,s.D$)((t=>e.$emit("show-register")),["prevent"]))},"Don't have an account? Register")])])}var l={name:"LoginForm",data(){return{username:"",password:""}},methods:{login(){fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this.password})}).then((e=>e.json())).then((e=>{"登录成功"===e.message?this.$emit("login-success"):alert(e.message)})).catch((e=>{console.error("Error:",e)}))}}},h=n(6262);const d=(0,h.A)(l,[["render",c]]);var p=d;const g=(0,o.Lk)("h1",null,"Register",-1),m={class:"switch-form"};function f(e,t,n,r,a,i){return(0,o.uX)(),(0,o.CE)("div",null,[g,(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.username=e),placeholder:"Username",required:""},null,512),[[s.Jo,a.username]]),(0,o.bo)((0,o.Lk)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e),placeholder:"Password",required:""},null,512),[[s.Jo,a.password]]),(0,o.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>i.register&&i.register(...e))},"Register"),(0,o.Lk)("div",m,[(0,o.Lk)("a",{href:"#",onClick:t[3]||(t[3]=(0,s.D$)((t=>e.$emit("show-login")),["prevent"]))},"Already have an account? Login")])])}var v={name:"RegisterForm",data(){return{username:"",password:""}},methods:{register(){fetch("/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username,password:this.password})}).then((e=>e.json())).then((e=>{alert(e.message),"注册成功"===e.message&&this.$emit("show-login")})).catch((e=>{console.error("Error:",e)}))}}};const w=(0,h.A)(v,[["render",f]]);var y=w;const k=e=>((0,o.Qi)("data-v-001a90fb"),e=e(),(0,o.jt)(),e),L=k((()=>(0,o.Lk)("h1",null,"Chat with AI",-1))),C={id:"chat-messages",ref:"chatMessages"},b={id:"chat-input"},M={id:"upload-container"},E=k((()=>(0,o.Lk)("label",{for:"upload-input",id:"upload-label"},"Upload Documents",-1)));function O(e,t,n,r,a,i){const u=(0,o.g2)("ChatMessageComponent");return(0,o.uX)(),(0,o.CE)("div",null,[L,(0,o.Lk)("div",C,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.chatMessages,((e,t)=>((0,o.uX)(),(0,o.Wv)(u,{key:t,message:e},null,8,["message"])))),128))],512),(0,o.Lk)("div",b,[(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.userInput=e),onKeypress:t[1]||(t[1]=(0,s.jR)(((...e)=>i.sendMessage&&i.sendMessage(...e)),["enter"])),placeholder:"Type your message..."},null,544),[[s.Jo,a.userInput]]),(0,o.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>i.sendMessage&&i.sendMessage(...e))},"Send")]),(0,o.Lk)("div",M,[(0,o.Lk)("input",{type:"file",id:"upload-input",ref:"uploadInput",multiple:"",onChange:t[3]||(t[3]=(...e)=>i.handleFileUpload&&i.handleFileUpload(...e))},null,544),E]),(0,o.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>i.logout&&i.logout(...e)),style:{"margin-top":"20px"}},"Logout")])}var j=n(33);const A=["innerHTML"];function I(e,t,n,s,r,a){return(0,o.uX)(),(0,o.CE)("div",{class:(0,j.C4)(["message","user"===n.message.sender?"user-message":"ai-message"]),innerHTML:a.formattedMessage},null,10,A)}n(2450);var T=n(7453),V=n(508),x={name:"ChatMessageComponent",props:["message"],computed:{formattedMessage(){return"ai"===this.message.sender?(0,T.xI)(this.message.content,{highlight:function(e,t){const n=V.A.getLanguage(t)?t:"plaintext";return V.A.highlight(e,{language:n}).value}}):this.message.content}},mounted(){"ai"===this.message.sender&&this.$nextTick((()=>{this.$el.querySelectorAll("pre code").forEach((e=>{V.A.highlightElement(e)}))}))}};const S=(0,h.A)(x,[["render",I],["__scopeId","data-v-721e2f82"]]);var U=S,_={name:"ChatInterface",components:{ChatMessageComponent:U},data(){return{userInput:"",chatMessages:[]}},methods:{sendMessage(){if(""===this.userInput.trim())return;this.appendMessage("user",this.userInput);const e=this.userInput;this.userInput="",fetch("/ask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e})}).then((e=>{const t=e.body.getReader();let n="";const s=()=>{t.read().then((({done:e,value:t})=>{if(e)return void this.appendMessage("ai",n);const o=(new TextDecoder).decode(t);n+=o,this.updateLastAiMessage(n),s()}))};s()})).catch((e=>{console.error("Error:",e)}))},appendMessage(e,t){this.chatMessages.push({sender:e,content:t})},updateLastAiMessage(e){this.chatMessages.length>0&&"ai"===this.chatMessages[this.chatMessages.length-1].sender&&(this.chatMessages[this.chatMessages.length-1].content=e)},handleFileUpload(e){const t=e.target.files,n=new FormData;for(let s=0;s<t.length;s++)n.append("files",t[s]);fetch("/upload",{method:"POST",body:n}).then((e=>e.json())).then((e=>{alert(e.message)})).catch((e=>{console.error("Error:",e)}))},logout(){fetch("/logout").then((e=>e.json())).then((e=>{alert(e.message),this.$emit("logout")})).catch((e=>{console.error("Error:",e)}))},loadChatHistory(){fetch("/get_chat_history").then((e=>e.json())).then((e=>{e.chat_history.forEach((e=>{this.chatMessages.push(e)}))})).catch((e=>{console.error("Error:",e)}))}},mounted(){this.loadChatHistory()}};const X=(0,h.A)(_,[["render",O],["__scopeId","data-v-001a90fb"]]);var R=X,$={data(){return{currentView:"login"}},components:{Login:p,Register:y,Chat:R}};const F=(0,h.A)($,[["render",a]]);var J=F,P=n(5798);const q=[{path:"/login",component:p},{path:"/register",component:y},{path:"/chat",component:R}],D=(0,P.aE)({history:(0,P.LA)(),routes:q});var H=D;(0,s.Ef)(J).use(H).mount("#app")}},t={};function n(s){var o=t[s];if(void 0!==o)return o.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,s,o,r){if(!s){var a=1/0;for(l=0;l<e.length;l++){s=e[l][0],o=e[l][1],r=e[l][2];for(var i=!0,u=0;u<s.length;u++)(!1&r||a>=r)&&Object.keys(n.O).every((function(e){return n.O[e](s[u])}))?s.splice(u--,1):(i=!1,r<a&&(a=r));if(i){e.splice(l--,1);var c=o();void 0!==c&&(t=c)}}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[s,o,r]}}(),function(){n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,s){var o,r,a=s[0],i=s[1],u=s[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(o in i)n.o(i,o)&&(n.m[o]=i[o]);if(u)var l=u(n)}for(t&&t(s);c<a.length;c++)r=a[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(l)},s=self["webpackChunkai_chat_app"]=self["webpackChunkai_chat_app"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=n.O(void 0,[504],(function(){return n(311)}));s=n.O(s)})();
//# sourceMappingURL=app.c817f047.js.map